---
layout: post
title: "O uso de cookies e a violação da privacidade - o caso NebuAd"
date: 2009-06-01
tags: Casos,privacidade
author: None
---
Por Ruy Jos&eacute; Guerra Barretto de Queiroz
A ind&uacute;stria do an&uacute;ncio online est&aacute; no cerne da economia da internet. Conforme um levantamento recente da PriceWaterhouseCoopers (&ldquo;IAB Internet Advertising Revenue Report&rdquo;, Mar&ccedil;o 2009), as receitas com an&uacute;ncio online continuam a bater recordes: nos EUA chegaram a U$6,1 bilh&otilde;es no &uacute;ltimo trimestre de 2008, um aumento de 4,5% em rela&ccedil;&atilde;o ao trimestre anterior (US$5,8 bilh&otilde;es) e de 2,6% em rela&ccedil;&atilde;o ao &uacute;ltimo trimestre de 2007 (US$5,9 bi). As receitas totais em 2008 atingiram a marca de US$23,4 bilh&otilde;es, 10,6% a mais que os US$21,2 bilh&otilde;es registrados em 2007. 

Segundo Randal Rothenberg, CEO da Internet Advertising Bureau, &ldquo;estamos assistindo a um deslocamento secular cont&iacute;nuo [da propaganda] das m&iacute;dias tradicionais para a m&iacute;dia online &agrave; medida em que os marqueteiros reconhecem que os d&oacute;lares de an&uacute;ncios investidos na m&iacute;dia interativa s&atilde;o eficazes em influenciar consumidores e em produzir resultados mensur&aacute;veis. Nessa economia de incertezas, onde marqueteiros sabem que precisam fazer mais com menos, o an&uacute;ncio interativo prov&ecirc; as ferramentas para que eles possam construir relacionamentos profundos e envolventes com os consumidores &ndash; a experi&ecirc;ncia que os marqueteiros ganham com isso lhes trar&aacute; dividendos especialmente depois que a economia volte ao ritmo normal.&rdquo;&nbsp; 

Um relat&oacute;rio recente da Nielsen confirma a tend&ecirc;ncia: se, por um lado, o investimento em an&uacute;ncio online por parte do setor financeiro, vendas a varejo e autom&oacute;veis diminuiu a um passo forte nos &uacute;ltimos seis meses, por outro lado, os fabricantes de produtos empacotados, a ind&uacute;stria farmac&ecirc;utica e as empresas de telecomunica&ccedil;&otilde;es, 3 dos maiores investidores em propaganda, est&atilde;o vindo para a internet num ritmo nunca visto. Com tudo isso, no entanto, a ind&uacute;stria do an&uacute;ncio online mostrou tamb&eacute;m que, mesmo n&atilde;o estando livre da recess&atilde;o econ&ocirc;mica, vem sofrendo menos que o restante da economia. 

Os n&uacute;meros divulgados em 01/05/09 pelas 4 maiores arrecadadoras de receitas com an&uacute;ncio online (Google, Yahoo, Microsoft, e AOL) sobre o 1&ordm; trimestre de 2009 revelam uma queda de 2% em rela&ccedil;&atilde;o ao ano anterior, e de 7% em rela&ccedil;&atilde;o ao &uacute;ltimo trimestre de 2008. O fato &eacute; que o ritmo de crescimento dessa ind&uacute;stria tem desacelerado desde o in&iacute;cio da crise, mas esse &eacute; o primeiro trimestre a experimentar um verdadeiro decl&iacute;nio em receitas. Somente a Google n&atilde;o teve resultado negativo.
A bem da verdade, a propaganda na internet tem suas vantagens: (1) oferece publica&ccedil;&atilde;o imediata de an&uacute;ncios sem limita&ccedil;&atilde;o de geografia ou de tempo; (2) pode ser personalizada atrav&eacute;s do rastreamento de usu&aacute;rios espacialmente sobre diferentes portais e sobre o tempo; (3) oferece mais facilidade para se mensurar o interesse do consumidor nos an&uacute;ncios atrav&eacute;s da contagem de &ldquo;clicks&rdquo; sobre o an&uacute;ncio.&nbsp; Em nome da usabilidade e da monetiza&ccedil;&atilde;o de seus portais, empresas de conte&uacute;do de internet normalmente interagem com dom&iacute;nios de terceiros para integrar an&uacute;ncios e da&iacute; gerar receita. Na verdade, um novo modelo de neg&oacute;cios baseado em an&uacute;ncios online criou novas oportunidades para blogueiros, jornais, e aplica&ccedil;&otilde;es web. 

At&eacute; mesmo os usu&aacute;rios t&ecirc;m sido beneficiados pelo an&uacute;ncio online pois ele financia o acesso livre a conte&uacute;do e servi&ccedil;os de valor inestim&aacute;vel. Por exemplo, jornais oferecem artigos gratuitamente online e geram receita a partir dos an&uacute;ncios. Igualmente, a Google oferece um servi&ccedil;o de correio eletr&ocirc;nico (Gmail) competitivo e gratuito, que exibe an&uacute;ncios e assim gera receita. Al&eacute;m disso, aos usu&aacute;rios os an&uacute;ncios online podem trazer informa&ccedil;&otilde;es relevantes, especialmente se o an&uacute;ncio for direcionado. &Eacute; por essa raz&atilde;o que, para melhorar a relev&acirc;ncia dos an&uacute;ncios e garantir uma melhor experi&ecirc;ncia online ao usu&aacute;rio, os anunciantes fazem uso de tecnologias de rastreamento das atividades do usu&aacute;rio por meio da grava&ccedil;&atilde;o de pequenos arquivos conhecidos como &ldquo;cookies&rdquo; no sistema de arquivos do usu&aacute;rio. 

Segundo a Wikipedia, um cookie &eacute; uma cadeia de texto armazenada no computador do usu&aacute;rio por um navegador contendo um ou mais pares &lsquo;nome-valor&rsquo; de informa&ccedil;&otilde;es tais como prefer&ecirc;ncias do usu&aacute;rio, conte&uacute;do de carrinho de compras eletr&ocirc;nico, identificador de uma sess&atilde;o baseada em servidor, ou outros dados usados por portais. &Eacute; normalmente enviado como um cabe&ccedil;alho do protocolo HTTP por um servidor para um cliente web, e a&iacute; enviado de volta sem altera&ccedil;&atilde;o pelo cliente a cada vez que ele acessa aquele servidor. 

O termo &quot;cookie&quot; tem origem no conceito &quot;magic cookie&quot; do sistema operacional UNIX que se referia a um mecanismo de troca de dados entre programas atrav&eacute;s de um arquivo curto de modo que seu conte&uacute;do tipicamente n&atilde;o tinha significado para o receptor mas serviria para o emissor ao receb&ecirc;-lo de volta e reabri-lo. Por essa caracter&iacute;stica &ldquo;opaca&rdquo; ao receptor, por&eacute;m com conte&uacute;do significativo para o emissor, esse arquivo ganhou o nome de cookie em refer&ecirc;ncia ao &ldquo;fortune cookie&rdquo; (biscoitinho da sorte).
Os cookies enviados ao servidor que hospeda a p&aacute;gina visitada s&atilde;o chamados de &ldquo;cookies de primeira&rdquo; (em ingl&ecirc;s &ldquo;first-party cookies&rdquo;), e s&atilde;o usados pelos servidores para memorizar o estado da conex&atilde;o, de modo a identificar o usu&aacute;rio numa visita posterior. Como as p&aacute;ginas web podem conter refer&ecirc;ncias a componentes necess&aacute;rios para a boa exibi&ccedil;&atilde;o da p&aacute;gina (por exemplo, imagens ou an&uacute;ncios), os navegadores frequentemente emitem solicita&ccedil;&otilde;es adicionais atrav&eacute;s do protocolo HTTP especificamente para esses elementos, que podem estar armazenados em outros dom&iacute;nios. 

Estes &uacute;ltimos, por sua vez, podem vir a enviar cookies ao usu&aacute;rio, e esses s&atilde;o os chamados &ldquo;cookies de terceiros&rdquo; (em ingl&ecirc;s, &ldquo;third-party cookies&rdquo;), que v&atilde;o permitir o rastreamento do usu&aacute;rio por parte de terceiros. Conforme sua fun&ccedil;&atilde;o, os cookies s&atilde;o classificados em cookies de sess&atilde;o (que n&atilde;o t&ecirc;m data de validade, mas expiram ap&oacute;s o t&eacute;rmino da sess&atilde;o), e os cookies persistentes aos quais est&aacute; associada uma data de expira&ccedil;&atilde;o.
Em geral, essa &ldquo;intrus&atilde;o&rdquo; pode ser evitada ou controlada pelo pr&oacute;prio usu&aacute;rio atrav&eacute;s de comandos ou op&ccedil;&otilde;es dispon&iacute;veis no software de navega&ccedil;&atilde;o na internet. H&aacute;, no entanto, casos em que o rastreamento excessivo e at&eacute; subliminar leva a uma amea&ccedil;a s&eacute;ria de invas&atilde;o de privacidade. Um desses casos, ali&aacute;s, um tanto emblem&aacute;tico, parece ter chegado a um desfecho recentemente: a NebuAd, uma empresa americana de propaganda online baseada em Redwood City, California, com escrit&oacute;rios em Nova York e Londres, e com investimentos de Sierra Ventures e de Menlo Ventures (dois grandes nomes do chamado &ldquo;capital de risco&rdquo;), ap&oacute;s ter sua senten&ccedil;a de morte anunciada desde que o Congresso americano a for&ccedil;ou a mudar sua estrat&eacute;gia de rastreamento do usu&aacute;rio atrav&eacute;s do provedor de servi&ccedil;os h&aacute; um ano atr&aacute;s, finalmente fechou suas portas: em 15/05/09 seus advogados entraram com uma notifica&ccedil;&atilde;o para o Juiz Distrital Edward Chen de San Francisco informando seu fechamento. 

A NebuAd surgiu como um dos grandes destaques entre as empresas de desenvolvimento de sistemas de an&uacute;ncio online baseados em direcionamento comportamental associados a acordos com provedores de servi&ccedil;os de modo a lhes habilitar a analisar os h&aacute;bitos de navega&ccedil;&atilde;o dos clientes com o objetivo de fornecer an&uacute;ncios mais relevantes e micro-direcionados. Outras empresas atuando no setor incluem a brit&acirc;nica Phorm, tamb&eacute;m alvo de acusa&ccedil;&otilde;es de invas&atilde;o de privacidade, Perftech, Quarad e Front Porch, al&eacute;m das mais recentes Adzilla e Project Rialto. Num certo momento, a NebuAd contava com mais de 30 clientes, na maior parte provedores de acesso &agrave; internet, e seus acordos com os provedores cobriam cerca de 10% dos usu&aacute;rios de banda larga dos Estados Unidos.
O produto da NebuAd era composto de tr&ecirc;s partes: (1) um equipamento hospedado no provedor de acesso &agrave; internet que era capaz de inserir conte&uacute;do em p&aacute;ginas solicitadas pelo usu&aacute;rio (e poderia monitorar at&eacute; 50 mil usu&aacute;rios), (2) um servidor complexo utilizado para analisar e categorizar o conte&uacute;do das comunica&ccedil;&otilde;es realizadas pelo usu&aacute;rio, e (3) relacionamentos com redes de anunciantes que desejassem oferecer a propaganda direcionada da NebuAd. O regime de participa&ccedil;&atilde;o adotava a pol&iacute;tica de &ldquo;opt-out&rdquo;, isto &eacute;, o usu&aacute;rio poderia optar por n&atilde;o participar do esquema de monitoramento (e conseq&uuml;ente melhora da relev&acirc;ncia dos an&uacute;ncios), mas teria que se manifestar. 

N&atilde;o obstante, o usu&aacute;rio n&atilde;o tinha como impedir que o provedor enviasse os dados &agrave; NebuAd. Em posi&ccedil;&atilde;o privilegiada, o provedor teria condi&ccedil;&otilde;es de monitorar e analisar, por meio de &ldquo;deep packet inspection&rdquo; (inspe&ccedil;&atilde;o profunda dos pacotes de comunica&ccedil;&atilde;o, algo como abrir um envelope e observar seu conte&uacute;do, para logo ap&oacute;s fech&aacute;-lo novamente e repassar adiante) todo o tr&aacute;fego do usu&aacute;rio. 

A pol&iacute;tica de privacidade da NebuAd, no entanto, dizia que a empresa &ldquo;especificamente n&atilde;o armazenaria ou usaria qualquer informa&ccedil;&atilde;o relacionada a informa&ccedil;&atilde;o m&eacute;dica confidencial, de origem racial ou &eacute;tnica, de cren&ccedil;as religiosas, ou de sexualidade que estivessem associadas a informa&ccedil;&otilde;es pessoais identific&aacute;veis (&lsquo;personal identifiable information&rsquo;).&rdquo; Por outro lado, a empresa advertia que &quot;as informa&ccedil;&otilde;es que coletamos s&atilde;o processadas nos servidores da NebuAd nos Estados Unidos. Assim, essas informa&ccedil;&otilde;es podem estar sujeitas a requisi&ccedil;&otilde;es de acesso por parte de governos, cortes ou pol&iacute;cia.&quot;
Apesar da receita adicional que permitia aos provedores, e da maior relev&acirc;ncia dos an&uacute;ncios oferecidos ao usu&aacute;rio, a NebuAd parecia estar sempre causando preocupa&ccedil;&atilde;o aos defensores dos direitos &agrave; privacidade na internet. Havia questionamentos sobre: (1) a falta de transpar&ecirc;ncia dos provedores em rela&ccedil;&atilde;o ao uso dos servi&ccedil;os da NebuAd, (2) um m&eacute;todo &ldquo;opt-out&rdquo; fraco (seria poss&iacute;vel sair do regime de an&uacute;ncio direcionado operado pelo provedor, mas n&atilde;o necessariamente do regime de entrega de seus dados &agrave; NebuAd), (3) a falta de vigil&acirc;ncia sobre o que uma terceira empresa faz com o conte&uacute;do das comunica&ccedil;&otilde;es via internet, (4) os conflitos entre o servi&ccedil;o da NebuAd e as leis de escuta (&ldquo;wiretap&rdquo;) americanas, e (5) a recusa da NebuAd em revelar os provedores com os quais tinha parceria. Finalmente, veio um ind&iacute;cio forte de que algo estava errado: em 10/03/2008, um usu&aacute;rio da empresa de internet por cabo Wide Open West (WOW) escreveu para o portal DSLreports.com: &ldquo;a conex&atilde;o da WOW est&aacute; for&ccedil;ando conex&otilde;es e cookies na minha m&aacute;quina quando visito a google.com.&rdquo; 

No dia seguinte outro usu&aacute;rio revela suspeita semelhante: &ldquo;Achei que voc&ecirc;s gostariam de saber, que estou suspeitando de meu provedor, Wide Open West. Sou da &aacute;rea de Chicagoland, e certamente parece que eles est&atilde;o permitindo que a NebuAD infecte a rede deles (desculpa, - minha interpreta&ccedil;&atilde;o pessoal...estou bem irritado com isso) e alterando p&aacute;ginas para incluir seus cookies de rastreamento. At&eacute; onde sei, n&atilde;o receb&iacute; qualquer aviso de que eles estariam tentando essa proeza.&rdquo;
Ap&oacute;s a ampla divulga&ccedil;&atilde;o das suspeitas dos usu&aacute;rios da WOW, e de outros parceiros da NebuAd, os membros da C&acirc;mara dos Representantes Edward Markey (Democrata, Massachussetts, Presidente da Subcomiss&atilde;o de Telecomunica&ccedil;&otilde;es e Internet) e Joe Barton (Republicano, Texas) enviaram em 16/05/08 uma carta &agrave; Charter Communications (quarta maior empresa de comunica&ccedil;&otilde;es por cabo, e parceira da NebuAd), invocando a desistir dos planos de rastreamento de usu&aacute;rios e convocando para uma audi&ecirc;ncia p&uacute;blica no Congresso americano. 

Segundo os signat&aacute;rios, &ldquo;os planos da Charter Communications de vender informa&ccedil;&otilde;es sobre as atividades online de seus clientes acendem diversas luzes vermelhas. Simplesmente prover um m&eacute;todo para usu&aacute;rios sair do regime n&atilde;o &eacute; o mesmo que pedir aos usu&aacute;rios para afirmativamente concordar em participar do programa. Essas quest&otilde;es sobre privacidade e o quanto esse empreendimento est&aacute; consistente com as leis de privacidade nas comunica&ccedil;&otilde;es devem ser enfrentadas antes que a empresa siga adiante com seus planos.&quot;
Nesse momento entra em cena Robb Topolski, o mesmo que, tamb&eacute;m em 2008, provou que a Comcast estava ludibriando seus clientes e violando a neutralidade da rede, dessa vez como t&eacute;cnico respons&aacute;vel pela investiga&ccedil;&atilde;o da NebuAd promovida por Free Press e Public Knowledge, organiza&ccedil;&otilde;es n&atilde;o-governamentais de defesa dos direitos civis na internet. Em 18/06/09 Topolski divulga um relat&oacute;rio t&eacute;cnico intitulado &ldquo;NebuAd and Partner ISPs: Wiretapping, Forgery and Browser Hijacking&rdquo; que conclui que a NebuAd usa equipamento especial que &ldquo;monitora, intercepta e modifica o conte&uacute;do de pacotes da internet&rdquo; &agrave; medida que os consumidores entram na internet. 

Com um registro detalhado dos testes e an&aacute;lises realizados nas p&aacute;ginas dos usu&aacute;rios e dos provedores parceiros, o relat&oacute;rio afirma que &ldquo;as pr&aacute;ticas da NebuAd se parecem com diversas formas de &lsquo;ataques&rsquo; em usu&aacute;rios que t&ecirc;m gerado consider&aacute;vel controv&eacute;rsia e condena&ccedil;&atilde;o pelos usu&aacute;rios&rdquo;: seq&uuml;estro de navegador, &lsquo;cross-site scripting&rsquo; (um tipo de ataque muito usado por cibercriminosos para roubar credenciais de forma extremamente sutil), numera&ccedil;&atilde;o &uacute;nica do processador para identificar o usu&aacute;rio (realizada pela Intel em 1999), viola&ccedil;&atilde;o de privacidade tal qual a brit&acirc;nica Phorm, gera&ccedil;&atilde;o de perfis realizada em 2002 pela DoubleClick (empresa de an&uacute;ncio online adquirida pela Google em 2008), ataque do &lsquo;homem-no-meio&rsquo; (uma forma de escuta ativa, em que o atacante se p&otilde;e entre dois interlocutores e se faz passar por um enquanto se comunica com o outro). 

Enfim, Topolski conclui que a NebuAd explora os comportamentos de um navegador normal forjando pacotes do protocolo de internet, fazendo com que seus pr&oacute;prios c&oacute;digos JavaScript sejam injetados no c&oacute;digo fonte no qual o navegador confia. E para isso conta com a colabora&ccedil;&atilde;o do provedor para empreender os ataques contra as inten&ccedil;&otilde;es do consumidor, contra os projetistas do software do navegador, e contra os donos dos servidores que eles visitam.&nbsp; O c&oacute;digo da p&aacute;gina web &eacute; normalmente baixado completamente a partir de servidores para clientes sobre uma &uacute;nica conex&atilde;o TCP, e uma vez que a p&aacute;gina &eacute; baixada, o c&oacute;digo obtido &eacute; executado pelo cliente. 

A execu&ccedil;&atilde;o desse c&oacute;digo &eacute; o que dispara as opera&ccedil;&otilde;es necess&aacute;rias para baixar imagens e outros recursos da p&aacute;gina, e esse c&oacute;digo &eacute; considerado seguro porque supostamente veio de uma fonte confiada pelo usu&aacute;rio. Entretanto, o c&oacute;digo da NebuAd injetado no c&oacute;digo fonte de uma p&aacute;gina de outrem &eacute; um ataque de &lsquo;cross-site scripting&rsquo; (XSS), e o comportamento subseq&uuml;ente de carregamento de cookies que normalmente n&atilde;o carregaria &eacute; um seq&uuml;estro do navegador. Isso significa que o que a NebuAd fazia era, na realidade, um ataque cl&aacute;ssico conhecido como &lsquo;homem-no-meio&rsquo;.
Gra&ccedil;as a Topolski, e para o bem da ind&uacute;stria e do consumidor, a NebuAd afinal se dissolveu.
PS: Ruy &eacute; professor associado do Centro de Inform&aacute;tica da UFPE e escreve para o Blog sempre &agrave;s segundas. 